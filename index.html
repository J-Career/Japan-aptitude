<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>日本生活適性診断</title>
<style>
  :root { --w: 680px; --brand: #111; }
  body { font-family: system-ui, -apple-system, "Noto Sans JP", sans-serif; margin: 0; background:#f7f7f8; color:#111; }
  header { max-width:var(--w); margin: 0 auto; padding: 20px 16px; }
  h1 { font-size: 1.4rem; margin: 8px 0 4px; }
  p.desc { color:#444; margin:0 0 8px; }
  main { max-width: var(--w); margin: 0 auto; padding: 8px 16px 88px; }
  .card { background:#fff; border-radius:16px; box-shadow:0 2px 12px rgba(0,0,0,.06); padding:16px; margin:12px 0; }
  .q { display:grid; gap:8px; }
  .q h3 { font-size:1rem; margin:0; }
  .scale { display:flex; gap:6px; justify-content:space-between; }
  /* ここから*/
.scale label {
  flex: 1;
  cursor: pointer;
  user-select: none;
  display: block; }
.scale label span {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 12px 8px;
  min-height: 44px;
  border: 1px solid #ddd;
  border-radius: 10px;
  transition: background .15s ease, border-color .15s ease, color .15s ease;
}

/* ここ*/

  .visually-hidden {
    position:absolute !important;
    width:1px; height:1px;
    margin:-1px; padding:0; border:0;
    clip:rect(0 0 0 0); clip-path: inset(50%);
    overflow:hidden; white-space:nowrap;
  }
 .scale input:checked + span {
  background: #FFB347;
  color: #111;
  border-color: #FFB347;
}


/* お好みで：タップ中のワンテンポの見た目 */
.scale label:active span {
  background: #FFB347;
  border-color: #FFB347;
}

/* お好みで：キーボード操作時のフォーカス可視化 */
.scale input:focus + span {
  outline: 2px solid #FFB347;
  outline-offset: 2px;
}
  .actions { position:sticky; bottom:0; left:0; right:0; background:linear-gradient(180deg, rgba(247,247,248,0), #f7f7f8 40%, #f7f7f8); padding:16px; }
  button { width:100%; padding:14px 16px; border-radius:12px; border:none; background:#111; color:#fff; font-size:1.05rem; font-weight:700; }
  button:disabled { opacity:.5; }
  .result { text-align:center; }
  .score { font-size:2.2rem; margin:8px 0; }
  .badge { display:inline-block; padding:6px 10px; border-radius:999px; font-weight:700; }
  .hi { background:#16a34a22; color:#166534; border:1px solid #16a34a55; }
  .mid { background:#f59e0b22; color:#92400e; border:1px solid #f59e0b55; }
  .lo { background:#ef444422; color:#991b1b; border:1px solid #ef444455; }
  .tips { text-align:left; margin-top:12px; }
  .share { display:flex; gap:8px; margin-top:12px; }
  .linklike { background:#fff; color:#111; border:1px solid #ddd; }
  .fineprint { font-size:.85rem; color:#666; }
  .footerlink { text-align:center; margin-top:8px; }
  a.ext { color:#111; }
</style>
</head>
<body>
  <header>
    <h1>日本生活適性診断</h1>
    <p class="desc">20問・約2分。</br>1=全く当てはまらない 〜5=とても当てはまる。</p>
  </header>

  <main id="app"></main>

  <div class="actions">
    <button id="submitBtn" disabled>診断する</button>
    <div class="footerlink">
      <a class="ext" href="#" id="openExternal">外部ブラウザで開く</a>
    </div>
  </div>

<script>
const QUESTIONS = [
  { id:'q1',  text:'一人でも楽しく過ごしている方だ。' },
  { id:'q2',  text:'慣れない環境に適応するのにストレスを感じない' },
  { id:'q3',  text:'指示や規則に従うことに抵抗感がない' },
  { id:'q4',  text:'雰囲気や相手の気分をよく気にする方だ' },
  { id:'q5',  text:'喧嘩するより穏便に済ませたい' },
  { id:'q6',  text:'自分と違う部分も尊重しようと努力できる' },
  { id:'q7',  text:'韓国よりも遅い行政/サービスに耐える自信がある' },
  { id:'q8',  text:'団体活動で協力して物事を進めることができる' },
  { id:'q9',  text:'日本語をよく知らなくても学びたい意思がある' },
  { id:'q10', text:'ラーメンが好き' },
  { id:'q11', text:'時間厳守（約束や締切）を意識して行動できる' },
  { id:'q12', text:'書類の手続き（役所/学校/銀行）に取り組める' },
  { id:'q13', text:'混雑時でも落ち着いて行動できる' },
  { id:'q14', text:'頑張れる' },
  { id:'q15', text:'周囲に配慮した音量や行動を心がけている' },
  { id:'q16', text:'天気や季節に合わせた生活準備（服装/防災）ができる' },
  { id:'q17', text:'支援情報（自治体サイト等）を自分で探せる' },
  { id:'q18', text:'礼儀正しい言葉づかいを意識できる' },
  { id:'q19', text:'職場や学校での役割やルールを理解し守れる' },
  { id:'q20', text:'新しい習慣を少しずつ取り入れるのが得意' },
];

const app = document.getElementById('app');
const submitBtn = document.getElementById('submitBtn');

function renderForm() {
  app.innerHTML = '';
  QUESTIONS.forEach((q, idx) => {
    const options = [1,2,3,4,5].map(v => {
      const rid = `${q.id}_${v}`;
      return `
        <label for="${rid}">
          <input class="visually-hidden" id="${rid}" type="radio" name="${q.id}" value="${v}">
          <span>${v}</span>
        </label>
      `;
    }).join('');

    const card = document.createElement('section');
    card.className = 'card q';
    card.innerHTML = `
      <h3>${idx+1}. ${q.text}</h3>
      <div class="scale" role="radiogroup" aria-label="${q.text}">
        ${options}
      </div>
    `;
    app.appendChild(card);
  });
  app.appendChild(document.createElement('div')).className = 'space';
}

function getAnswers() {
  return QUESTIONS.map(q => {
    const el = document.querySelector(`input[name="${q.id}"]:checked`);
    return el ? Number(el.value) : null;
  });
}

function validate() {
  const a = getAnswers();
  const ok = a.every(v => v !== null);
  submitBtn.disabled = !ok;
}


function calcScore(values) {
  return values.reduce((s,v)=> s + v, 0);
}

function scoreBand(score){
  if(score >= 80) return { tag:'高', cls:'hi', advice:[
    '超適正あるよ',
    'ううううう',
    'あいうえお'
  ]};
  if(score >= 50) return { tag:'中', cls:'mid', advice:[
    '適正まあまああるよ',
    'らららら',
    'あああああ'
  ]};
  return { tag:'低', cls:'lo', advice:[
    '適正ないわ',
    'うふふふ',
    'ほほほほ'
  ]};
}

function renderResult(score){
  const band = scoreBand(score);
  app.innerHTML = `
    <section class="card result">
      <div class="badge ${band.cls}">適性：${band.tag}</div>
      <div class="score">${score} / 100</div>
      <p class="fineprint">（20問×1〜5点の合計＝20〜100点）</p>
      <div class="tips card">
        <h3>ワンポイントアドバイス</h3>
        <ul>${band.advice.map(t => `<li>${t}</li>`).join('')}</ul>
      </div>
      <div class="share">
        <button id="copyBtn" class="linklike">結果をコピー</button>
        <button id="retryBtn" class="linklike">もう一度</button>
      </div>
    </section>
  `;

  document.getElementById('copyBtn').onclick = async () => {
    const text = `日本生活適性診断：${score}/100（${band.tag}）`;
    try { await navigator.clipboard.writeText(text); alert('結果をコピーしました'); }
    catch(e){ prompt('コピーできない場合は手動で選択→コピーしてください', text); }
  };

  document.getElementById('retryBtn').onclick = () => {
    renderForm(); attachListeners();
  };
}

function attachListeners(){
  document.querySelectorAll('input[type="radio"]').forEach(i=>{
    i.addEventListener('change', validate);
  });
}

document.getElementById('openExternal').addEventListener('click', (e)=>{
  e.preventDefault();
  window.open(window.location.href, '_blank');
});

renderForm();
attachListeners();

submitBtn.addEventListener('click', ()=>{
  const answers = getAnswers();
  if(answers.some(v => v === null)) return;
  const score = calcScore(answers);
  renderResult(score);
});
</script>
</body>
</html>
